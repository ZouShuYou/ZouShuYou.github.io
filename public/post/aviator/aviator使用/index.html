<!doctype html><html lang=zh-CN data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.126.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon_me.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon_me.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16.ico><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32.ico><link rel=apple-touch-icon sizes=180x180 href><meta itemprop=name content="Aviator的初步了解和使用"><meta itemprop=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="http://localhost:1313/imgs/me.png"><meta itemprop=keywords content><meta property="og:type" content="article"><meta property="og:title" content="Aviator的初步了解和使用"><meta property="og:description" content><meta property="og:image" content="/imgs/me.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="http://localhost:1313/post/aviator/aviator%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="shuyou"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="shuyou"><meta property="article:published_time" content="2021-01-18 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2024-06-09 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"aviator%E4%BD%BF%E7%94%A8","permalink":"http://localhost:1313/post/aviator/aviator%E4%BD%BF%E7%94%A8/","title":"Aviator的初步了解和使用","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Aviator的初步了解和使用 - shuyou</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>shuyou</h1><i class=logo-line></i></a></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>64</span></a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-folder hvr-icon"></i>标签</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#1aviator简介>1.Aviator简介</a></li><li><a href=#2aviator入门常用>2.Aviator入门常用</a><ul><li><ul><li><a href=#21数据类型>2.1数据类型</a></li><li><a href=#22操作符>2.2操作符</a></li></ul></li></ul></li><li><a href=#3一些简单特性>3.一些简单特性</a></li><li><a href=#4官方函数例子官方代码>4.官方函数例子(官方代码)</a></li><li><a href=#5支持大数据操作>5.支持大数据操作</a></li><li><a href=#6正则表达式匹配>6.正则表达式匹配</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=shuyou src=/imgs/img-lazy-loading.gif data-src=/imgs/me.png><p class=site-author-name itemprop=name>shuyou</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>64</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>16</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/zoushuyou title="Github → https://github.com/zoushuyou" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=2022-01-06T00:00:00+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=95564></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=223></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2024-06-10T00:00:00+00:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://zoushuyou.github.io/ rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=http://localhost:1313/post/aviator/aviator%E4%BD%BF%E7%94%A8/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/me.png"><meta itemprop=name content="shuyou"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="shuyou"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Aviator的初步了解和使用"><meta itemprop=description content="&ldquo;初步了解和使用Aviator&rdquo; 1.Aviator简介 Aviator 是一个高性能，轻量级的java语言实现的表达式求值引擎，主要"></span><header class=post-header><h1 class=post-title itemprop="name headline">Aviator的初步了解和使用
<a href=https://github.com/zoushuyou/zoushuyou.github.io/content/post/Aviator/aviator%e4%bd%bf%e7%94%a8.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2021-01-18 00:00:00 +0000 UTC" itemprop="dateCreated datePublished" datetime="2021-01-18 00:00:00 +0000 UTC">2021-01-18
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title=修改时间：2024-06-09T00:00:00+00:00 itemprop=dateModified datetime=2024-06-09T00:00:00+00:00>2024-06-09</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/aviator itemprop=url rel=index><span itemprop=name>Aviator</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2903</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>6分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/aviator/aviator%E4%BD%BF%E7%94%A8/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><blockquote><p>&ldquo;初步了解和使用Aviator&rdquo;</p></blockquote><h2 id=1aviator简介>1.Aviator简介
<a class=header-anchor href=#1aviator%e7%ae%80%e4%bb%8b></a></h2><p>Aviator 是一个高性能，轻量级的java语言实现的<strong>表达式求值引擎</strong>，主要用于各种表达式的动态求值。</p><p><a href=https://www.yuque.com/boyan-avfmj/aviatorscript/ra28g1#f67a50b4 title=官方文档 rel="noopener external nofollow noreferrer" target=_blank class=exturl>官方文档
<i class="fa fa-external-link-alt"></i></a></p><p><a href=https://github.com/killme2008/aviatorscript title=github地址 rel="noopener external nofollow noreferrer" target=_blank class=exturl>github地址
<i class="fa fa-external-link-alt"></i></a></p><blockquote><p>支持数字、字符串、正则表达式、布尔值、正则表达式等基本类型，完整支持所有 Java 运算符及优先级等。
函数是一等公民，支持闭包和函数式编程。
内置 bigint/decmal 类型用于大整数和高精度运算，支持运算符重载得以让这些类型使用普通的算术运算符 +-*/ 参与运算。
完整的脚本语法支持，包括多行数据、条件语句、循环语句、词法作用域和异常处理等。
函数式编程结合 Sequence 抽象，便捷处理任何集合。
轻量化的模块系统。
多种方式，方便地调用 Java 方法，完整支持 Java 脚本 API（方便从 Java 调用脚本）。
丰富的定制选项，可作为安全的语言沙箱和全功能语言使用。
轻量化，高性能，通过直接将脚本翻译成 JVM 字节码，AviatorScript 的基础性能较好。</p></blockquote><p>使用场景包括：</p><ol><li>规则判断及规则引擎</li><li>公式计算</li><li>动态脚本控制</li><li>集合数据 ELT 等 ……</li></ol><h2 id=2aviator入门常用>2.Aviator入门常用
<a class=header-anchor href=#2aviator%e5%85%a5%e9%97%a8%e5%b8%b8%e7%94%a8></a></h2><blockquote><p><strong>这里使用版本为4.2.5</strong></p></blockquote><h4 id=21数据类型>2.1数据类型
<a class=header-anchor href=#21%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b></a></h4><ul><li>Number类型: 数字类型,支持四种类型,分别是long,double,java.math.BigInteger(简称 big int)和java.math.BigDecimal(简 称 decimal),规则如下:<ul><li>任何以大写字母 N 结尾的整数都被认为是 big int</li><li>任何以大写字母 M 结尾的数字都被认为是 decimal</li><li>其他的任何整数都将被转换为 Long</li><li>其他任何浮点数都将被转换为 Double</li><li>超过 long 范围的整数字面量都将自动转换为 big int 类型</li></ul></li><li>String类型: 字符串类型,单引号或者双引号括起来的文本串,如&rsquo;hello world&rsquo;, 变量如果传入的是String或者Character也将转为String类型</li><li>Bool类型: 常量true和false,表示真值和假值,与 java 的Boolean.TRUE和Boolean.False对应</li><li>Pattern类型: 正则表达式, 以//括起来的字符串,如/\d+/,内部 实现为java.util.Pattern</li><li>变量类型: 与 Java 的变量命名规则相同,变量的值由用户传入</li><li>nil类型: 常量nil,类似 java 中的null,但是nil比较特殊,nil不仅可以参与==、!=的比较, 也可以参与>、>=、&lt;、&lt;=的比较,Aviator 规定任何类型都大于nil除了nil本身,nil==nil返回true。 用户传入的变量值如果为null,那么也将作为nil处理,nil打印为null</li></ul><h4 id=22操作符>2.2操作符
<a class=header-anchor href=#22%e6%93%8d%e4%bd%9c%e7%ac%a6></a></h4><h5 id=算术运算符>算术运算符
<a class=header-anchor href=#%e7%ae%97%e6%9c%af%e8%bf%90%e7%ae%97%e7%ac%a6></a></h5><p>Aviator 支持常见的算术运算符,包括+ - * / %五个二元运算符,和一元运算符-(负)。其中- * / %和一元的-仅能作用于Number类型。
+不仅能用于Number类型,还可以用于String的相加,或者字符串与其他对象的相加。
Aviator 规定,任何类型与String相加,结果为String。</p><h5 id=逻辑运算符>逻辑运算符
<a class=header-anchor href=#%e9%80%bb%e8%be%91%e8%bf%90%e7%ae%97%e7%ac%a6></a></h5><p>Avaitor 的支持的逻辑运算符包括,一元否定运算符!,以及逻辑与的&&,逻辑或的||。逻辑运算符的操作数只能为Boolean。
&&和||都执行短路规则。</p><h5 id=关系运算符>关系运算符
<a class=header-anchor href=#%e5%85%b3%e7%b3%bb%e8%bf%90%e7%ae%97%e7%ac%a6></a></h5><p>Aviator 支持的关系运算符包括&lt;, &lt;=, >, >=以及==和!= 。
关系运算符可以作用于Number之间、String之间、Pattern之间、Boolean之间、变量之间以及其他类型与nil之间的关系比较, 不同类型除了nil之外不能相互比较。</p><h2 id=3一些简单特性>3.一些简单特性
<a class=header-anchor href=#3%e4%b8%80%e4%ba%9b%e7%ae%80%e5%8d%95%e7%89%b9%e6%80%a7></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> aviator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.AviatorEvaluator;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.Expression;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.function.AbstractFunction;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.function.AbstractVariadicFunction;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.function.FunctionUtils;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.type.AviatorDouble;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.type.AviatorObject;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.runtime.type.AviatorString;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.HashMap;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Map;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author zousy
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @version v1.0
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @Description
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @date 2021-01-16 15:39
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>App</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>//执行表达式 Aviator的数值类型仅支持Long和Double, 任何整数都将转换成Long,</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 任何浮点数都将转换为Double, 包括用户传入的变量数值</span>
</span></span><span style=display:flex><span>        Object execute <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;1+1+2&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(execute.<span style=color:#a6e22e>toString</span>() <span style=color:#f92672>+</span> execute.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getSimpleName</span>());
</span></span><span style=display:flex><span>        Object execute1 <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;2.3+3.0&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(execute1.<span style=color:#a6e22e>toString</span>() <span style=color:#f92672>+</span> execute1.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getSimpleName</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//内置函数和 多行表达式 使用; 隔开</span>
</span></span><span style=display:flex><span>        Expression compile <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>getInstance</span>().<span style=color:#a6e22e>compile</span>(<span style=color:#e6db74>&#34;println(&#39;Hello, AviatorScript!&#39;); 1+2&#34;</span>);
</span></span><span style=display:flex><span>        Object res <span style=color:#f92672>=</span> compile.<span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(res.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//使用变量</span>
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;name&#34;</span>,<span style=color:#e6db74>&#34;zsad&#34;</span>);
</span></span><span style=display:flex><span>        String execute2 <span style=color:#f92672>=</span> (String) AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34; &#39;hello&#39; + name&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(execute2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//支持函数调用</span>
</span></span><span style=display:flex><span>        Object execute3 <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.length(&#39;hello&#39;)&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(execute3.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//支持通过 lambda 关键字定义一个匿名函数，并且支持闭包捕获</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//lambda (参数1,参数2...) -&gt; 参数体表达式 end</span>
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;x&#34;</span>,1);
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;y&#34;</span>,10);
</span></span><span style=display:flex><span>        Object execute4 <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;(lambda (x,y) -&gt; x + y end)(x,y)&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(execute4.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//支持自定义函数</span>
</span></span><span style=display:flex><span>        AviatorEvaluator.<span style=color:#a6e22e>addFunction</span>(<span style=color:#66d9ef>new</span> AddFunction());
</span></span><span style=display:flex><span>        AviatorEvaluator.<span style=color:#a6e22e>addFunction</span>(<span style=color:#66d9ef>new</span> GetFirstNonNullFunction());
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;a&#34;</span>,12);
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;v&#34;</span>,13);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//参数确定 自定义函数</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;add(1,33)&#34;</span>).<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>        <span style=color:#75715e>//参数不确定自定义函数</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;getFirstNonNull(a,v,bas,asf)&#34;</span>,env));
</span></span><span style=display:flex><span>        <span style=color:#75715e>//lambda表达式 自定义函数</span>
</span></span><span style=display:flex><span>        AviatorEvaluator.<span style=color:#a6e22e>defineFunction</span>(<span style=color:#e6db74>&#34;sub&#34;</span>,<span style=color:#e6db74>&#34;lambda (a,b) -&gt; a - b end&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;sub(12,13)&#34;</span>).<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>        <span style=color:#75715e>//lambda表达式支持闭包 自定义函数  ? 按照官方写 会报错  存疑</span>
</span></span><span style=display:flex><span>        AviatorEvaluator.<span style=color:#a6e22e>defineFunction</span>(<span style=color:#e6db74>&#34;sub2&#34;</span>,<span style=color:#e6db74>&#34;lambda (a) -&gt; lambda (b) -&gt; a - b end end&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;sub2(12)(14)&#34;</span>).<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//参数确定 继承 AbstractFunction</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AddFunction</span> <span style=color:#66d9ef>extends</span> AbstractFunction {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> AviatorObject <span style=color:#a6e22e>call</span>(Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env, AviatorObject arg1, AviatorObject arg2) {
</span></span><span style=display:flex><span>            Number left <span style=color:#f92672>=</span> FunctionUtils.<span style=color:#a6e22e>getNumberValue</span>(arg1, env);
</span></span><span style=display:flex><span>            Number right <span style=color:#f92672>=</span> FunctionUtils.<span style=color:#a6e22e>getNumberValue</span>(arg2, env);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> AviatorDouble(left.<span style=color:#a6e22e>doubleValue</span>() <span style=color:#f92672>+</span> right.<span style=color:#a6e22e>doubleValue</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//函数名 add</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;add&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//参数不确定 继承 AbstractVariadicFunction</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GetFirstNonNullFunction</span> <span style=color:#66d9ef>extends</span> AbstractVariadicFunction {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> AviatorObject <span style=color:#a6e22e>variadicCall</span>(Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env, AviatorObject... args) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (args <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (AviatorObject arg : args) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (arg.<span style=color:#a6e22e>getValue</span>(env) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> arg;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> AviatorString(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;getFirstNonNull&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>运行结果</strong>
<img src=/imgs/img-lazy-loading.gif data-src="https://img-blog.csdnimg.cn/20210118160419292.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NhcnJvdFpzeQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><h2 id=4官方函数例子官方代码>4.官方函数例子(官方代码)
<a class=header-anchor href=#4%e5%ae%98%e6%96%b9%e5%87%bd%e6%95%b0%e4%be%8b%e5%ad%90%e5%ae%98%e6%96%b9%e4%bb%a3%e7%a0%81></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> aviator.example;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.AviatorEvaluator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Arrays;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.HashMap;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Map;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author zousy
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @version v1.0
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @Description
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @date 2021-01-18 15:59
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FunctionExample</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;sysdate()&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;rand()&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;now()&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;date_to_string(sysdate(),&#39;yyyy-MM-dd&#39;)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string_to_date(date_to_string(sysdate(),&#39;yyyy-MM-dd&#39;),&#39;yyyy-MM-dd&#39;)&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// string function</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;test string function...&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.length(&#39;hello&#39;)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.contains(&#39;hello&#39;,&#39;h&#39;)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.startsWith(&#39;hello&#39;,&#39;h&#39;)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.endsWith(&#39;hello&#39;,&#39;llo&#39;)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(
</span></span><span style=display:flex><span>                AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.contains(\&#34;test\&#34;,string.substring(&#39;hello&#39;,1,2))&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(Arrays
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>toString</span>((String<span style=color:#f92672>[]</span>) AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;string.split(&#39;hello world,aviator&#39;,&#39; &#39;)&#34;</span>)));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// math function</span>
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;test math function...&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.abs(-3)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.pow(-3,2)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.sqrt(14.0)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.log(100)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.log10(1000)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.sin(20)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.cos(99.23)&#34;</span>));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;math.tan(19.9)&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// seq lib</span>
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        ArrayList<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> list <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        list.<span style=color:#a6e22e>add</span>(3);
</span></span><span style=display:flex><span>        list.<span style=color:#a6e22e>add</span>(100);
</span></span><span style=display:flex><span>        list.<span style=color:#a6e22e>add</span>(<span style=color:#f92672>-</span>100);
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;list&#34;</span>, list);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;reduce(list,+,0)&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;filter(list,seq.exists())&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;count(list)&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;include(list,100)&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;sort(list)&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;map(list,println)&#34;</span>, env));
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(list);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>运行结果</strong></p><p><img src=/imgs/img-lazy-loading.gif data-src="https://img-blog.csdnimg.cn/20210118160714133.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NhcnJvdFpzeQ==,size_16,color_FFFFFF,t_70" alt=运行结果></p><h2 id=5支持大数据操作>5.支持大数据操作
<a class=header-anchor href=#5%e6%94%af%e6%8c%81%e5%a4%a7%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> aviator.example;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.AviatorEvaluator;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.Options;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.math.BigDecimal;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.math.BigInteger;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.math.MathContext;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.HashMap;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Map;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author zousy
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @version v1.0
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @Description
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @date 2021-01-18 16:10
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BigNumberExample</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//以大写字母N为后缀的整数都被认为是big int,如1N,2N,9999999999999999999999N等, 都是big int类型。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//超过long范围的整数字面量都将自动转换为big int类型。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//以大写字母M为后缀的数字都被认为是decimal, 如1M,2.222M, 100000.9999M等, 都是decimal类型。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//big int和decimal的运算,跟其他数字类型long,double没有什么区别,操作符仍然是一样的。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// aviator重载了基本算术操作符来支持这两种新类型:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        Object rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;9223372036854775807100.356M * 2&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;92233720368547758074+1000&#34;</span>);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        BigInteger a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BigInteger(String.<span style=color:#a6e22e>valueOf</span>(Long.<span style=color:#a6e22e>MAX_VALUE</span>) <span style=color:#f92672>+</span> String.<span style=color:#a6e22e>valueOf</span>(Long.<span style=color:#a6e22e>MAX_VALUE</span>));
</span></span><span style=display:flex><span>        BigDecimal b <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BigDecimal(<span style=color:#e6db74>&#34;3.2&#34;</span>);
</span></span><span style=display:flex><span>        BigDecimal c <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BigDecimal(<span style=color:#e6db74>&#34;9999.99999&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;a&#34;</span>, a);
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;b&#34;</span>, b);
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;c&#34;</span>, c);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;a+10000000000000000000&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;b+c*2&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;a*b/c&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// set math context</span>
</span></span><span style=display:flex><span>        AviatorEvaluator.<span style=color:#a6e22e>setOption</span>(Options.<span style=color:#a6e22e>MATH_CONTEXT</span>, MathContext.<span style=color:#a6e22e>DECIMAL64</span>);
</span></span><span style=display:flex><span>        rt <span style=color:#f92672>=</span> AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;a*b/c&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(rt <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#f92672>+</span> rt.<span style=color:#a6e22e>getClass</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>运行结果</strong>
<img src=/imgs/img-lazy-loading.gif data-src="https://img-blog.csdnimg.cn/20210118163700982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NhcnJvdFpzeQ==,size_16,color_FFFFFF,t_70" alt=运行结果></p><h2 id=6正则表达式匹配>6.正则表达式匹配
<a class=header-anchor href=#6%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e5%8c%b9%e9%85%8d></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> aviator.example;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.googlecode.aviator.AviatorEvaluator;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.HashMap;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Map;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author zousy
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @version v1.0
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @Description
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @date 2021-01-18 16:40
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RegularExpressionExample</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//email与正则表达式/([\\w0-8]+@\\w+[\\.\\w+]+)/通过=~操作符来匹配,结果为一个 Boolean 类 型,</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 因此可以用于三元表达式判断,匹配成功的时候返回$1,指代正则表达式的分组 1,也就是用户名,否则返回unknown。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Aviator 在表达式级别支持正则表达式,通过//括起来的字符序列构成一个正则表达式,</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 正则表达式可以用于匹配(作为=~的右操作数)、比较大小。但是匹配仅能与字符串进行匹配。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 匹配成功后, Aviator 会自动将匹配成功的捕获分组(capturing groups) 放入 env ${num}的变量中,</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 其中$0 指代整个匹配的字符串,而$1表示第一个分组，$2表示第二个分组以此类推。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//请注意，分组捕获放入 env 是默认开启的，因此如果传入的 env 不是线程安全并且被并发使用，可能存在线程安全的隐患。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 关闭分组匹配，可以通过 AviatorEvaluator.setOption(Options.PUT_CAPTURING_GROUPS_INTO_ENV, false);来关闭，对性能有稍许好处。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Aviator 的正则表达式规则跟 Java 完全一样,因为内部其实就是使用java.util.regex.Pattern做编译的。</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>final</span> String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        String email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;killme2008@gmail.com&#34;</span>;
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> env <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        env.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;email&#34;</span>, email);
</span></span><span style=display:flex><span>        String username <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                (String) AviatorEvaluator.<span style=color:#a6e22e>execute</span>(<span style=color:#e6db74>&#34;email=~/([\\w0-8]+)@\\w+[\\.\\w+]+/ ? $1:&#39;unknow&#39;&#34;</span>, env);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(username);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>运行结果</strong>
<img src=/imgs/img-lazy-loading.gif data-src="https://img-blog.csdnimg.cn/20210118164657569.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NhcnJvdFpzeQ==,size_16,color_FFFFFF,t_70" alt=运行结果></p></div><footer class=post-footer><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Aviator的初步了解和使用</li><li class=post-copyright-author><strong>本文作者： </strong>shuyou</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=http://localhost:1313/post/aviator/aviator%E4%BD%BF%E7%94%A8/ title=Aviator的初步了解和使用>http://localhost:1313/post/aviator/aviator%E4%BD%BF%E7%94%A8/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/java-base/java%E9%9B%86%E5%90%88%E5%B0%8F%E7%BB%93/ rel=next title=Java集合小结><i class="fa fa-chevron-left"></i> Java集合小结</a></div><div class="post-nav-prev post-nav-item"><a href=/post/spring/spring-aop/spring-aop%E4%BD%BF%E7%94%A8/ rel=prev title="Spring AOP的初步使用">Spring AOP的初步使用
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2021 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>shuyou</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.126.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":"trueMuse","giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOMG_H3s4Cf_SS","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"zoushuyou/zoushuyou.github.io","repoid":"R_kgDOMG_H3g","theme":"light"},"js":"https://giscus.app/client.js"},"hostname":"http://localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.js defer></script></body></html>